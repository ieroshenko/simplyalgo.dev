#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ”§ Running pre-commit checks..."

# Run comprehensive security check
echo "ğŸ”’ Checking for secrets..."
if ! ./scripts/check-secrets.sh; then
  echo "âŒ Security check failed!"
  exit 1
fi

# Run basic formatting on staged files only
echo "ğŸ’… Formatting staged files..."
STAGED_FILES=$(git diff --cached --name-only)
if [ -n "$STAGED_FILES" ]; then
  npx prettier --write --ignore-unknown $STAGED_FILES
  # Add formatted files back to staging
  git add $STAGED_FILES
fi

echo "âœ… Pre-commit checks passed!"
